# opencode-cloud Railway template-base compose
#
# Import this file into Railway only as a base for template workflows.
# The canonical runtime compose for local/quick-deploy remains
# docker-compose.yml.
#
# Intentional Railway importer compatibility constraints:
# - single persisted volume only
# - fixed image string (no env interpolation in "image")
# - import-focused subset of compose keys; runtime knobs kept where supported

services:
  opencode:
    image: prizz/opencode-cloud-sandbox:latest
    pull_policy: ${OPENCODE_PULL_POLICY:-missing}
    restart: unless-stopped
    init: true
    stop_grace_period: ${OPENCODE_STOP_GRACE_PERIOD:-30s}
    environment:
      OPENCODE_HOST: ${OPENCODE_HOST:-0.0.0.0}
    logging:
      driver: ${OPENCODE_LOG_DRIVER:-json-file}
      options:
        max-size: ${OPENCODE_LOG_MAX_SIZE:-10m}
        max-file: "${OPENCODE_LOG_MAX_FILE:-3}"
    volumes:
      - opencode-data:/home/opencoder/.local/share/opencode

volumes:
  opencode-data:
