#!/usr/bin/env bash
set -euo pipefail

# Sync README.md to npm package directories
# This ensures npmjs.com displays the current README
# Note: cli-node has package-specific README (passthrough wrapper docs)

ROOT_README="README.md"

if [[ -f "$ROOT_README" ]]; then
    cp "$ROOT_README" packages/core/README.md
    git add packages/core/README.md
fi

# Run cfn-lint when CloudFormation templates change.
if git diff --cached --name-only --diff-filter=ACMR | rg -q '^infra/aws/cloudformation/.*\.(ya?ml)$'; then
    cfn-lint infra/aws/cloudformation/*.yaml
fi
